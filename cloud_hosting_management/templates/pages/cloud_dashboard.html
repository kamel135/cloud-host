{% extends "templates/web.html" %}

{% block page_content %}
<h1>Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨Ùƒ ÙÙŠ Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ø§Ø³ØªØ¶Ø§ÙØ© Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠØ©</h1>

{% if frappe.session.user != "Guest" %}
  {% set cloud_customer = frappe.get_value("Cloud Customer", {"user": frappe.session.user}, "name") %}

  <div class="dashboard" style="padding: 20px; background: #f8f9fa;">
    <h3>ğŸ“¦ Ø¹Ø¯Ø¯ Ø§Ù„Ø®ÙˆØ§Ø¯Ù… Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ:</h3>
    <p>{{ frappe.get_all("Cloud Server", filters={"owner": frappe.session.user}, count=True) }}</p>

    <h3>ğŸ” Ø¹Ø¯Ø¯ Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª Ø§Ù„Ù†Ø´Ø·Ø©:</h3>
    <p>{{ frappe.get_all("Cloud Subscription", filters={"owner": frappe.session.user, "status": "Active"}, count=True) }}</p>

    <h3>ğŸ’° Ø¹Ø¯Ø¯ Ø§Ù„ÙÙˆØ§ØªÙŠØ± ØºÙŠØ± Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø©:</h3>
    <p>{{ frappe.get_all("Hosting Invoice", filters={"owner": frappe.session.user, "status": "Unpaid"}, count=True) }}</p>

    <h3>ğŸ« Ø¹Ø¯Ø¯ Ø§Ù„ØªØ°Ø§ÙƒØ± Ø§Ù„Ù…ÙØªÙˆØ­Ø©:</h3>
    <p>{{ frappe.get_all("Support Ticket", filters={"owner": frappe.session.user, "status": "Open"}, count=True) }}</p>

    <h3>ğŸ’³ Ø±ØµÙŠØ¯Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠ:</h3>
    <p>
      {{
        frappe.db.get_value("Cloud Customer", {"user": frappe.session.user}, "balance")
        or "0.00"
      }} USD
    </p>

    <h3>ğŸ§¾ Ø¢Ø®Ø± ÙØ§ØªÙˆØ±Ø©:</h3>
    {% set last_invoice = frappe.get_all("Hosting Invoice", filters={"owner": frappe.session.user}, fields=["name", "posting_date"], order_by="creation desc", limit=1) %}
    {% if last_invoice %}
      <p>Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø©: {{ last_invoice[0].name }} | Ø§Ù„ØªØ§Ø±ÙŠØ®: {{ last_invoice[0].posting_date }}</p>
    {% else %}
      <p>Ù„Ø§ ØªÙˆØ¬Ø¯ ÙÙˆØ§ØªÙŠØ± Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†.</p>
    {% endif %}
  </div>
{% else %}
  <p>ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ø¹Ø±Ø¶ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ.</p>
{% endif %}
{% endblock %}
